<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css" />
    <title>Document</title>
</head>

<body>
    <div class="chatbot">
        <h2>ì±—ë´‡</h2>
        <div id="chat-box"></div>

        <form id="chat-form">
            <input id="chat-input" type="text" placeholder="ì±—ë´‡ì—ê²Œ ë§ì„ ê±¸ì–´ë³´ì„¸ìš”" required />
            <button id="send-btn" type="submit">ì „ì†¡</button>
        </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
    <script type="module">
        import { chatbotData } from "./chatbotdata.js";  // âœ… ìˆ˜ì •ëœ ê²½ë¡œ

        const chatBox = document.getElementById("chat-box");
        const form = document.getElementById("chat-form");
        const input = document.getElementById("chat-input");

        let userNickname = "ì‚¬ìš©ìž";  // ê¸°ë³¸ ë‹‰ë„¤ìž„

        function addMessage(content, isUser = false) {
            const msg = document.createElement("div");
            msg.className = "msg " + (isUser ? "user" : "bot");
            msg.textContent = content;
            chatBox.appendChild(msg);
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        function getBotReply(question) {
            const q = question.toLowerCase();
            for (const item of chatbotData) {
                if (item.keywords.some(kw => q.includes(kw))) {
                    return typeof item.answer === "function" ? item.answer() : item.answer;
                }
            }
            return "ì£„ì†¡í•´ìš”, ì•„ì§ ê·¸ ì§ˆë¬¸ì€ ìž˜ ëª¨ë¥´ê² ì–´ìš” ðŸ¤–";
        }

        form.addEventListener("submit", (e) => {
            e.preventDefault();
            const question = input.value.trim();
            if (!question) return;

            addMessage(`${userNickname}: ${question}`, true);

            setTimeout(() => {
                const reply = getBotReply(question);
                addMessage(`ì±—ë´‡: ${reply}`, false);
            }, 500);

            input.value = "";
        });
    </script>
</body>

</html>